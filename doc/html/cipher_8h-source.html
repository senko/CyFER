<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>cipher.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>cipher.h</h1><a href="cipher_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00005 <span class="preprocessor">#ifndef _CIPHER_H_</span>
00006 <span class="preprocessor"></span><span class="preprocessor">#define _CIPHER_H_</span>
00007 <span class="preprocessor"></span>
<a name="l00008"></a><a class="code" href="cipher_8h.html#a0">00008</a> <span class="preprocessor">#define CYFER_CIPHER_NONE 0</span>
<a name="l00009"></a><a class="code" href="cipher_8h.html#a1">00009</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_CIPHER_BLOWFISH 1</span>
<a name="l00010"></a><a class="code" href="cipher_8h.html#a2">00010</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_CIPHER_DES 2</span>
<a name="l00011"></a><a class="code" href="cipher_8h.html#a3">00011</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_CIPHER_DESX 3</span>
<a name="l00012"></a><a class="code" href="cipher_8h.html#a4">00012</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_CIPHER_TRIPLEDES 4</span>
<a name="l00013"></a><a class="code" href="cipher_8h.html#a5">00013</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_CIPHER_RC2 5</span>
<a name="l00014"></a><a class="code" href="cipher_8h.html#a6">00014</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_CIPHER_RC4 6</span>
<a name="l00015"></a><a class="code" href="cipher_8h.html#a7">00015</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_CIPHER_RC5 7</span>
<a name="l00016"></a><a class="code" href="cipher_8h.html#a8">00016</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_CIPHER_RC6 8</span>
<a name="l00017"></a><a class="code" href="cipher_8h.html#a9">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_CIPHER_IDEA 9</span>
<a name="l00018"></a><a class="code" href="cipher_8h.html#a10">00018</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_CIPHER_AES 10</span>
<a name="l00019"></a><a class="code" href="cipher_8h.html#a11">00019</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_CIPHER_DEAL 11</span>
<a name="l00020"></a><a class="code" href="cipher_8h.html#a12">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_CIPHER_THREEWAY 12</span>
00021 <span class="preprocessor"></span>
<a name="l00022"></a><a class="code" href="cipher_8h.html#a13">00022</a> <span class="preprocessor">#define CYFER_MODE_NONE 0</span>
<a name="l00023"></a><a class="code" href="cipher_8h.html#a14">00023</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_MODE_ECB 1</span>
<a name="l00024"></a><a class="code" href="cipher_8h.html#a15">00024</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_MODE_CBC 2</span>
<a name="l00025"></a><a class="code" href="cipher_8h.html#a16">00025</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_MODE_CFB 3</span>
<a name="l00026"></a><a class="code" href="cipher_8h.html#a17">00026</a> <span class="preprocessor"></span><span class="preprocessor">#define CYFER_MODE_OFB 4</span>
00027 <span class="preprocessor"></span>
00028 
00029 <span class="preprocessor">#ifdef CYFER_INTERNAL</span>
00030 <span class="preprocessor"></span><span class="preprocessor">#include &lt;util.h&gt;</span>
00031 <span class="preprocessor">#include &lt;blowfish.h&gt;</span>
00032 <span class="preprocessor">#include &lt;des.h&gt;</span>
00033 <span class="preprocessor">#include &lt;desx.h&gt;</span>
00034 <span class="preprocessor">#include &lt;tripledes.h&gt;</span>
00035 <span class="preprocessor">#include &lt;rc2.h&gt;</span>
00036 <span class="preprocessor">#include &lt;rc4.h&gt;</span>
00037 <span class="preprocessor">#include &lt;rc5.h&gt;</span>
00038 <span class="preprocessor">#include &lt;rc6.h&gt;</span>
00039 <span class="preprocessor">#include &lt;idea.h&gt;</span>
00040 <span class="preprocessor">#include &lt;aes.h&gt;</span>
00041 <span class="preprocessor">#include &lt;deal.h&gt;</span>
00042 <span class="preprocessor">#include &lt;threeway.h&gt;</span>
00043 
00044 <span class="keyword">typedef</span> <span class="keyword">struct </span>{
00045         <span class="keywordtype">int</span> mode;
00046         <span class="keywordtype">void</span> *context;
00047         cyfer_crypt_handler_t encrypt;
00048         cyfer_crypt_handler_t decrypt;
00049         size_t length;
00050         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *chain;
00051         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *outbuf;
00052 } CYFER_BLOCK_MODE_CTX;
00053 
00054 <span class="keyword">typedef</span> <span class="keyword">struct </span>{
00055         <span class="keywordtype">int</span> type;
00056         <span class="keyword">union </span>{
00057                 BLOWFISH_CTX blowfish;
00058                 DES_CTX des;
00059                 DESX_CTX desx;
00060                 TRIPLEDES_CTX tripledes;
00061                 RC2_CTX rc2;
00062                 RC5_CTX rc5;
00063                 RC6_CTX rc6;
00064                 IDEA_CTX idea;
00065                 AES_CTX aes;
00066                 DEAL_CTX deal;
00067                 THREEWAY_CTX threeway;
00068         } u;
00069         CYFER_BLOCK_MODE_CTX mctx;
00070 } <a class="code" href="cipher_8h.html#a18">CYFER_BLOCK_CIPHER_CTX</a>;
00071 
00072 <span class="keyword">typedef</span> <span class="keyword">struct </span>{
00073         <span class="keywordtype">int</span> type;
00074         <span class="keyword">union </span>{
00075                 RC4_CTX rc4;
00076         } u;
00077 } <a class="code" href="cipher_8h.html#a19">CYFER_STREAM_CIPHER_CTX</a>;
00078 
00079 <span class="preprocessor">#else</span>
00080 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="cyfer_8h.html">cyfer/cyfer.h</a>&gt;</span>
<a name="l00082"></a><a class="code" href="cipher_8h.html#a18">00082</a> <span class="keyword">typedef</span> <span class="keywordtype">void</span> <a class="code" href="cipher_8h.html#a18">CYFER_BLOCK_CIPHER_CTX</a>;
<a name="l00084"></a><a class="code" href="cipher_8h.html#a19">00084</a> <span class="keyword">typedef</span> <span class="keywordtype">void</span> <a class="code" href="cipher_8h.html#a19">CYFER_STREAM_CIPHER_CTX</a>;
00085 <span class="preprocessor">#endif</span>
00086 <span class="preprocessor"></span>
<a name="l00088"></a><a class="code" href="structCYFER__BlockCipher__t.html">00088</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00090"></a><a class="code" href="structCYFER__BlockCipher__t.html#m0">00090</a>         <span class="keywordtype">int</span> type;
<a name="l00092"></a><a class="code" href="structCYFER__BlockCipher__t.html#m1">00092</a>         <span class="keywordtype">char</span> *name;
<a name="l00094"></a><a class="code" href="structCYFER__BlockCipher__t.html#m2">00094</a>         size_t keylen;
<a name="l00096"></a><a class="code" href="structCYFER__BlockCipher__t.html#m3">00096</a>         size_t minkey;
<a name="l00098"></a><a class="code" href="structCYFER__BlockCipher__t.html#m4">00098</a>         size_t length;
00099 } <a class="code" href="structCYFER__BlockCipher__t.html">CYFER_BlockCipher_t</a>;
00100 
<a name="l00102"></a><a class="code" href="structCYFER__StreamCipher__t.html">00102</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00104"></a><a class="code" href="structCYFER__StreamCipher__t.html#m0">00104</a>         <span class="keywordtype">int</span> type;
<a name="l00106"></a><a class="code" href="structCYFER__StreamCipher__t.html#m1">00106</a>         <span class="keywordtype">char</span> *name;
<a name="l00108"></a><a class="code" href="structCYFER__StreamCipher__t.html#m2">00108</a>         size_t keylen;
<a name="l00110"></a><a class="code" href="structCYFER__StreamCipher__t.html#m3">00110</a>         size_t minkey;
00111 } <a class="code" href="structCYFER__StreamCipher__t.html">CYFER_StreamCipher_t</a>;
00112 
<a name="l00114"></a><a class="code" href="structCYFER__BlockMode__t.html">00114</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00116"></a><a class="code" href="structCYFER__BlockMode__t.html#m0">00116</a>         <span class="keywordtype">int</span> type;
<a name="l00118"></a><a class="code" href="structCYFER__BlockMode__t.html#m1">00118</a>         <span class="keywordtype">char</span> *name;
<a name="l00120"></a><a class="code" href="structCYFER__BlockMode__t.html#m2">00120</a>         size_t length;
00121 } <a class="code" href="structCYFER__BlockMode__t.html">CYFER_BlockMode_t</a>;
00122 
00123 
00124 <span class="preprocessor">#ifdef __cplusplus</span>
00125 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00126 <span class="preprocessor">#endif</span>
00127 <span class="preprocessor"></span>
00129 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <a class="code" href="structCYFER__BlockMode__t.html">CYFER_BlockMode_t</a> *<a class="code" href="cipher_8h.html#a20">CYFER_BlockCipher_Get_SupportedModes</a>(<span class="keywordtype">void</span>);
00130 
00132 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <a class="code" href="structCYFER__BlockCipher__t.html">CYFER_BlockCipher_t</a> *<a class="code" href="cipher_8h.html#a21">CYFER_BlockCipher_Get_Supported</a>(<span class="keywordtype">void</span>);
00133 
00141 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <span class="keywordtype">int</span> <a class="code" href="cipher_8h.html#a22">CYFER_BlockCipher_Select</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, size_t *keylen, size_t *minkey, size_t *length);
00142 
00149 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <span class="keywordtype">int</span> <a class="code" href="cipher_8h.html#a23">CYFER_BlockCipher_SelectMode</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, size_t *length);
00150 
00160 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <a class="code" href="cipher_8h.html#a18">CYFER_BLOCK_CIPHER_CTX</a> *<a class="code" href="cipher_8h.html#a24">CYFER_BlockCipher_Init</a>(<span class="keywordtype">int</span> type, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *key, size_t keylen, <span class="keywordtype">int</span> mode, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *ivec);
00161 
00166 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <span class="keywordtype">void</span> <a class="code" href="cipher_8h.html#a25">CYFER_BlockCipher_Encrypt</a>(CYFER_BLOCK_CIPHER_CTX *ctx, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output);
00167 
00172 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <span class="keywordtype">void</span> <a class="code" href="cipher_8h.html#a26">CYFER_BlockCipher_Decrypt</a>(CYFER_BLOCK_CIPHER_CTX *ctx, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output);
00173 
00176 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <span class="keywordtype">void</span> <a class="code" href="cipher_8h.html#a27">CYFER_BlockCipher_Finish</a>(CYFER_BLOCK_CIPHER_CTX *ctx);
00177 
00179 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <a class="code" href="structCYFER__StreamCipher__t.html">CYFER_StreamCipher_t</a> *<a class="code" href="cipher_8h.html#a28">CYFER_StreamCipher_Get_Supported</a>(<span class="keywordtype">void</span>);
00180 
00187 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <span class="keywordtype">int</span> <a class="code" href="cipher_8h.html#a29">CYFER_StreamCipher_Select</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, size_t *keylen, size_t *minkey);
00188 
00194 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <a class="code" href="cipher_8h.html#a19">CYFER_STREAM_CIPHER_CTX</a> *<a class="code" href="cipher_8h.html#a30">CYFER_StreamCipher_Init</a>(<span class="keywordtype">int</span> type, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *key, size_t keylen);
00195 
00201 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <span class="keywordtype">void</span> <a class="code" href="cipher_8h.html#a31">CYFER_StreamCipher_Encrypt</a>(CYFER_STREAM_CIPHER_CTX *ctx, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output, size_t length);
00202 
00208 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <span class="keywordtype">void</span> <a class="code" href="cipher_8h.html#a32">CYFER_StreamCipher_Decrypt</a>(CYFER_STREAM_CIPHER_CTX *ctx, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output, size_t length);
00209 
00212 <a class="code" href="cyfer_8h.html#a0">CYFER_API</a> <span class="keywordtype">void</span> <a class="code" href="cipher_8h.html#a33">CYFER_StreamCipher_Finish</a>(CYFER_STREAM_CIPHER_CTX *ctx);
00213 
00214 <span class="preprocessor">#ifdef __cplusplus</span>
00215 <span class="preprocessor"></span>};
00216 <span class="preprocessor">#endif </span>
00217 <span class="preprocessor"></span>
00218 <span class="preprocessor">#endif </span><span class="comment">/* _CIPHER_H_ */</span>
00219 
</pre></div><hr><address style="align: right;"><small>Generated on Sun Sep 26 13:53:58 2004 for Cyfer by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc3 </small></address>
</body>
</html>
